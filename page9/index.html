<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> watermint.org &middot; Takayuki Okazaki's note </title> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/watermint-logo.png"> <link rel="shortcut icon" href="/public/watermint-logo.png"> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <style>*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html,body{margin:0;padding:0}html{font-family:serif;font-size:14px;line-height:1.8}@media(min-width:38em){html{font-size:20px}}body{color:#515151;background-color:#fff;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}a{color:#268bd2;text-decoration:none}a strong{color:inherit}a:hover,a:focus{text-decoration:underline}h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:bold;line-height:1.25;color:#313131;text-rendering:optimizeLegibility}h1{font-size:1.5rem;margin-top:1.6rem;margin-bottom:1.6rem}h2{margin-top:1.6rem;font-size:1.3rem}h3{margin-top:1.6rem;font-size:1.2rem}h4,h5,h6{margin-top:1rem;font-size:1rem}p{margin-top:0;margin-bottom:1rem}strong{color:#303030}ul,ol,dl{margin-top:0;margin-bottom:1rem}dt{font-weight:bold}dd{margin-bottom:.5rem}hr{position:relative;margin:1.5rem 0;border:0;border-top:1px solid #eee;border-bottom:1px solid #fff}abbr{font-size:85%;font-weight:bold;color:#555;text-transform:uppercase}abbr[title]{cursor:help;border-bottom:1px dotted #e5e5e5}code,pre{font-family:Menlo,Monaco,"Courier New",monospace}code{padding:.25em .5em;font-size:85%;color:#bf616a;background-color:#f9f9f9;border-radius:3px}pre{display:block;margin-top:0;margin-bottom:1rem;padding:1rem;font-size:.8rem;line-height:1.4;white-space:pre;white-space:pre-wrap;word-break:break-all;word-wrap:break-word;background-color:#f9f9f9}pre code{padding:0;font-size:100%;color:inherit;background-color:transparent}.highlight{margin-bottom:1rem;border-radius:4px}.highlight pre{margin-bottom:0}.gist .gist-file{font-family:Menlo,Monaco,"Courier New",monospace!important}.gist .markdown-body{padding:15px}.gist pre{padding:0;background-color:transparent}.gist .gist-file .gist-data{font-size:.8rem!important;line-height:1.4}.gist code{padding:0;color:inherit;background-color:transparent;border-radius:0}blockquote{padding:.5rem 1rem;margin:.8rem 0;color:#7a7a7a;border-left:.25rem solid #e5e5e5}blockquote p:last-child{margin-bottom:0}@media(min-width:30em){blockquote{padding-right:5rem;padding-left:1.25rem}}img{display:block;max-width:100%;margin:0 0 1rem;border-radius:5px}table{margin-bottom:1rem;width:100%;border:1px solid #e5e5e5;border-collapse:collapse}td,th{padding:.25rem .5rem;border:1px solid #e5e5e5}tbody tr:nth-child(odd) td,tbody tr:nth-child(odd) th{background-color:#f9f9f9}.lead{font-size:1.25rem;font-weight:300}.message{margin-bottom:1rem;padding:1rem;color:#717171;background-color:#f9f9f9}.container{max-width:38rem;padding-left:1rem;padding-right:1rem;margin-left:auto;margin-right:auto}.masthead{padding-top:1rem;padding-bottom:1rem;margin-bottom:3rem}.masthead-title{margin-top:0;margin-bottom:0;color:#505050}.masthead-title a{color:#505050}.masthead-title small{font-size:75%;font-weight:400;color:#c0c0c0;letter-spacing:0}.page,.post{margin-bottom:4em}.page-title,.post-title,.post-title a{color:#303030}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-.5rem;margin-bottom:1rem;color:#9a9a9a}.post-tags{display:block;margin-top:-.5rem;margin-bottom:1rem;text-align:right}.related{padding-top:2rem;padding-bottom:2rem;border-top:1px solid #eee}.related-posts{padding-left:0;list-style:none}.related-posts h3{margin-top:0}.related-posts li small{font-size:75%;color:#999}.related-posts li a:hover{color:#268bd2;text-decoration:none}.related-posts li a:hover small{color:inherit}.pagination{overflow:hidden;margin-left:-1rem;margin-right:-1rem;font-family:"PT Sans",Helvetica,Arial,sans-serif;color:#ccc;text-align:center}.pagination-item{display:block;padding:1rem;border:1px solid #eee}.pagination-item:first-child{margin-bottom:-1px}a.pagination-item:hover{background-color:#f5f5f5}@media(min-width:30em){.pagination{margin:3rem 0}.pagination-item{float:left;width:50%}.pagination-item:first-child{margin-bottom:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination-item:last-child{margin-left:-1px;border-top-right-radius:4px;border-bottom-right-radius:4px}}html,body{overflow-x:hidden;line-height:1.9em}html{font-family:serif}h1,h2,h3,h4,h5,h6{font-weight:400;color:#313131}.wrap{position:relative;width:100%}.container{max-width:28rem}@media(min-width:38em){.container{max-width:32rem}}@media(min-width:56em){.container{max-width:38rem}}.masthead{padding-top:1rem;padding-bottom:1rem;margin-bottom:3rem;border-bottom:1px solid #eee}.masthead-title{margin-top:0;margin-bottom:0;color:#505050}.masthead-title a{color:#505050}.masthead-title small{font-size:75%;font-weight:400;color:#c0c0c0;letter-spacing:0}@media(max-width:48em){.masthead-title{text-align:center}.masthead-title small{display:none}}.sidebar{position:fixed;top:0;bottom:0;left:-14rem;width:14rem;visibility:hidden;overflow-y:auto;font-family:serif;font-size:.875rem;line-height:1.4em;color:rgba(255,255,255,.6);background-color:#202020;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}
@media(min-width:30em){.sidebar{font-size:.75rem}}.sidebar a{font-weight:normal;color:#fff}.sidebar-item{padding:1rem}.sidebar-item p:last-child{margin-bottom:0}.sidebar-nav{border-bottom:1px solid rgba(255,255,255,.1)}.sidebar-nav-item{display:block;padding:.5rem 1rem;border-top:1px solid rgba(255,255,255,.1)}.sidebar-nav-item.active,a.sidebar-nav-item:hover,a.sidebar-nav-item:focus{text-decoration:none;background-color:rgba(255,255,255,.1);border-color:transparent}@media(min-width:48em){.sidebar-item{padding:1.5rem}.sidebar-nav-item{padding-left:1.5rem;padding-right:1.5rem}}.sidebar-checkbox{position:absolute;opacity:0;-webkit-user-select:none;-moz-user-select:none;user-select:none}.sidebar-toggle{position:absolute;top:.8rem;left:1rem;display:block;padding:.25rem .75rem;color:#555;border-radius:.25rem;cursor:pointer}.sidebar-toggle:before{display:inline-block;width:1rem;height:.75rem;content:"";background-image:-webkit-linear-gradient(to bottom,#555,#555 20%,#fff 20%,#fff 40%,#555 40%,#555 60%,#fff 60%,#fff 80%,#555 80%,#555 100%);background-image:-moz-linear-gradient(to bottom,#555,#555 20%,#fff 20%,#fff 40%,#555 40%,#555 60%,#fff 60%,#fff 80%,#555 80%,#555 100%);background-image:-ms-linear-gradient(to bottom,#555,#555 20%,#fff 20%,#fff 40%,#555 40%,#555 60%,#fff 60%,#fff 80%,#555 80%,#555 100%);background-image:linear-gradient(to bottom,#555,#555 20%,#fff 20%,#fff 40%,#555 40%,#555 60%,#fff 60%,#fff 80%,#555 80%,#555 100%)}.sidebar-toggle:active,#sidebar-checkbox:focus ~ .sidebar-toggle,#sidebar-checkbox:checked ~ .sidebar-toggle{color:#fff}.sidebar-toggle:active:before,#sidebar-checkbox:focus ~ .sidebar-toggle:before,#sidebar-checkbox:checked ~ .sidebar-toggle:before{background-image:-webkit-linear-gradient(to bottom,#fff 0%,#fff 20%,#d28445 20%,#d28445 40%,#fff 40%,#fff 60%,#d28445 60%,#d28445 80%,#fff 80%,#fff 100%);background-image:-moz-linear-gradient(to bottom,#fff 0%,#fff 20%,#d28445 20%,#d28445 40%,#fff 40%,#fff 60%,#d28445 60%,#d28445 80%,#fff 80%,#fff 100%);background-image:-ms-linear-gradient(to bottom,#fff 0%,#fff 20%,#d28445 20%,#d28445 40%,#fff 40%,#fff 60%,#d28445 60%,#d28445 80%,#fff 80%,#fff 100%);background-image:linear-gradient(to bottom,#fff 0%,#fff 20%,#d28445 20%,#d28445 40%,#fff 40%,#fff 60%,#d28445 60%,#d28445 80%,#fff 80%,#fff 100%)}@media(min-width:30.1em){.sidebar-toggle{position:fixed}}@media print{.sidebar-toggle{display:none}}.wrap,.sidebar,.sidebar-toggle{-webkit-backface-visibility:hidden;-ms-backface-visibility:hidden;backface-visibility:hidden}.wrap,.sidebar-toggle{-webkit-transition:-webkit-transform .3s ease-in-out;transition:transform .3s ease-in-out}#sidebar-checkbox:checked+.sidebar{z-index:10;visibility:visible}#sidebar-checkbox:checked ~ .sidebar,#sidebar-checkbox:checked ~ .wrap,#sidebar-checkbox:checked ~ .sidebar-toggle{-webkit-transform:translateX(14rem);-ms-transform:translateX(14rem);transform:translateX(14rem)}.page,.post{margin-bottom:4em}.page-title,.post-title,.post-title a{color:#303030}.page-title,.post-title{margin-top:0}.post-date{display:block;margin-top:-.5rem;margin-bottom:1rem;color:#9a9a9a}.related{padding-top:2rem;padding-bottom:2rem;border-top:1px solid #eee}.related-posts{padding-left:0;list-style:none}.related-posts h3{margin-top:0}.related-posts li small{font-size:75%;color:#999}.related-posts li a:hover{color:#268bd2;text-decoration:none}.related-posts li a:hover small{color:inherit}.pagination{overflow:hidden;margin-left:-1rem;margin-right:-1rem;font-family:serif;color:#ccc;text-align:center}.pagination-item{display:block;padding:1rem;border:1px solid #eee}.pagination-item:first-child{margin-bottom:-1px}a.pagination-item:hover{background-color:#f5f5f5}@media(min-width:30em){.pagination{margin:3rem 0}.pagination-item{float:left;width:50%}.pagination-item:first-child{margin-bottom:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination-item:last-child{margin-left:-1px;border-top-right-radius:4px;border-bottom-right-radius:4px}}.layout-reverse .sidebar{left:auto;right:-14rem}.layout-reverse .sidebar-toggle{left:auto;right:1rem}.layout-reverse #sidebar-checkbox:checked ~ .sidebar,.layout-reverse #sidebar-checkbox:checked ~ .wrap,.layout-reverse #sidebar-checkbox:checked ~ .sidebar-toggle{-webkit-transform:translateX(-14rem);-ms-transform:translateX(-14rem);transform:translateX(-14rem)}.theme-base-08 .sidebar,.theme-base-08 .sidebar-toggle:active,.theme-base-08 #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#ac4142}.theme-base-08 .container a,.theme-base-08 .sidebar-toggle,.theme-base-08 .related-posts li a:hover{color:#ac4142}.theme-base-09 .sidebar,.theme-base-09 .sidebar-toggle:active,.theme-base-09 #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#d28445}.theme-base-09 .container a,.theme-base-09 .sidebar-toggle,.theme-base-09 .related-posts li a:hover{color:#d28445}.theme-base-0a .sidebar,.theme-base-0a .sidebar-toggle:active,.theme-base-0a #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#f4bf75}
.theme-base-0a .container a,.theme-base-0a .sidebar-toggle,.theme-base-0a .related-posts li a:hover{color:#f4bf75}.theme-base-0b .sidebar,.theme-base-0b .sidebar-toggle:active,.theme-base-0b #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#90a959}.theme-base-0b .container a,.theme-base-0b .sidebar-toggle,.theme-base-0b .related-posts li a:hover{color:#90a959}.theme-base-0c .sidebar,.theme-base-0c .sidebar-toggle:active,.theme-base-0c #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#75b5aa}.theme-base-0c .container a,.theme-base-0c .sidebar-toggle,.theme-base-0c .related-posts li a:hover{color:#75b5aa}.theme-base-0d .sidebar,.theme-base-0d .sidebar-toggle:active,.theme-base-0d #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#6a9fb5}.theme-base-0d .container a,.theme-base-0d .sidebar-toggle,.theme-base-0d .related-posts li a:hover{color:#6a9fb5}.theme-base-0e .sidebar,.theme-base-0e .sidebar-toggle:active,.theme-base-0e #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#aa759f}.theme-base-0e .container a,.theme-base-0e .sidebar-toggle,.theme-base-0e .related-posts li a:hover{color:#aa759f}.theme-base-0f .sidebar,.theme-base-0f .sidebar-toggle:active,.theme-base-0f #sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#8f5536}.theme-base-0f .container a,.theme-base-0f .sidebar-toggle,.theme-base-0f .related-posts li a:hover{color:#8f5536}.sidebar-overlay #sidebar-checkbox:checked ~ .wrap{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}.sidebar-overlay #sidebar-checkbox:checked ~ .sidebar-toggle{box-shadow:0 0 0 .25rem #fff}.sidebar-overlay #sidebar-checkbox:checked ~ .sidebar{box-shadow:.25rem 0 .5rem rgba(0,0,0,.1)}.layout-reverse.sidebar-overlay #sidebar-checkbox:checked ~ .sidebar{box-shadow:-.25rem 0 .5rem rgba(0,0,0,.1)}.highlight table td{padding:5px}.highlight table pre{margin:0}.highlight,.highlight .w{color:#586e75}.highlight .err{color:#002b36;background-color:#dc322f}.highlight .c,.highlight .cd,.highlight .cm,.highlight .c1,.highlight .cs{color:#657b83}.highlight .cp{color:#b58900}.highlight .nt{color:#b58900}.highlight .o,.highlight .ow{color:#93a1a1}.highlight .p,.highlight .pi{color:#93a1a1}.highlight .gi{color:#859900}.highlight .gd{color:#dc322f}.highlight .gh{color:#268bd2;background-color:#002b36;font-weight:bold}.highlight .k,.highlight .kn,.highlight .kp,.highlight .kr,.highlight .kv{color:#6c71c4}.highlight .kc{color:#cb4b16}.highlight .kt{color:#cb4b16}.highlight .kd{color:#cb4b16}.highlight .s,.highlight .sb,.highlight .sc,.highlight .sd,.highlight .s2,.highlight .sh,.highlight .sx,.highlight .s1{color:#859900}.highlight .sr{color:#2aa198}.highlight .si{color:#d33682}.highlight .se{color:#d33682}.highlight .nn{color:#b58900}.highlight .nc{color:#b58900}.highlight .no{color:#b58900}.highlight .na{color:#268bd2}.highlight .m,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .il,.highlight .mo,.highlight .mb,.highlight .mx{color:#859900}.highlight .ss{color:#859900}.copyright{font-size:.8em;font-style:italic;color:#555}</style> </head> <body class="theme-base-09"> <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"> <div class="sidebar" id="sidebar"> <div class="sidebar-item"> <p>Travel, camera, photo, and technical things. I work at Dropbox. Thoughts are my own.</p> </div> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Home</a> <a class="sidebar-nav-item" href="/about/">About</a> <a class="sidebar-nav-item" href="/archive/">Archive</a> <a class="sidebar-nav-item" href="/tags/">Tags</a> <a class="sidebar-nav-item" href="/atom.xml">Feed</a> <a class="sidebar-nav-item" href="https://github.com/watermint">Github</a> <a class="sidebar-nav-item" href="https://www.instagram.com/watermint/">Instagram</a> </nav> <div class="sidebar-item"> <p> &copy; 2005-2020 Takayuki Okazaki </p> </div> </div> <div class="wrap"> <div class="masthead"> <div class="container"> <h3 class="masthead-title"> <a href="/" title="Home">watermint.org</a> <small>- Takayuki Okazaki's note</small> </h3> </div> </div> <div class="container content"> <div class="posts"> <div class="post"> <h1 class="post-title"> <a href="/2013/12/13/bootstrap-like-ui-framework-for-javafx-and-scalafx/"> Twitter Bootstrap like UI framework for JavaFX/ScalaFX </a> </h1> <span class="post-date"> 13th December 2013</span> <span class="post-tags"> #<a href="/tags/bootstrap">bootstrap</a> #<a href="/tags/design">design</a> #<a href="/tags/framework">framework</a> #<a href="/tags/java">java</a> #<a href="/tags/javafx">javafx</a> #<a href="/tags/scala">scala</a> #<a href="/tags/scalafx">scalafx</a> #<a href="/tags/ui">ui</a> #<a href="/tags/ux">ux</a> </span> <h2 id="feeling-of-applications">Feeling of Applications</h2> <p>Applications which running on iOS, Android, Windows, and OS X have nearly identical user experience. There are guidelines of fonts, color, margins, etc for labels, buttons, etc including effects or animation for action. User experience guidelines are publicly available for developers like below.</p> <ul> <li><a href="https://developer.apple.com/library/ios/documentation/userexperience/conceptual/mobilehig/">iOS Human Interface Guidelines</a></li> <li><a href="http://developer.android.com/design/index.html">Design Android Developers</a></li> <li><a href="http://msdn.microsoft.com/en-us/library/windowsphone/design/hh202915(v=vs.105).aspx">Design library for Windows Phone</a></li> </ul> <p>Application developers and designers refer these guidelines, then design UI/UX for their applications. For iOS and Windows Phones have official review for publishing on application store. Applications may reject when their applications are not compatible with design guidelines.</p> <h2 id="twitter-bootstrap">Twitter Bootstrap</h2> <p>However, there are no reviews for cross platform applications like web applications. Web applications may have different feeling compared to their native applications. Of course, we could find guidelines or best practices for web application UI/UX design. For example, <a href="http://getbootstrap.com/">Bootstrap</a> is well known UI framework for designing web applications. Bootstrap is collection of CSS/JavaScript to define UI component and their categories. Defined UI components are like</p> <ul> <li>Red button for destructive operation like delete file, delete repository, etc.</li> <li>Yellow text region for attention to the user to describe warnings.</li> </ul> <p><img src="/images/2013-12-13-fextile-bootstrapcomponents.png" alt="Bootstrap UI components"/></p> <p>Bootstrap also have customization feature, called theme, to define own color scheme, fonts, sizes, etc.</p> <h2 id="javafx-and-ui-framework">JavaFX and UI framework</h2> <p>JavaFX is a new UI framework running on Java. JavaFX have varieties of UI components, like buttons, tab pane, tables, lists, sliders etc.</p> <p><img src="/images/2013-12-13-fextile-javafxcomponents.jpg" alt="JavaFX UI components"/></p> <p>However, at least I know, there is no UI framework like Twitter Bootstrap. There are no definitions like button for destructive operation, warning text, approval operation, etc. That’s why I started development of UI framework for JavaFX/ScalaFX.</p> <h2 id="fextile-ui-framework-for-javafxscalafx">Fextile; UI framework for JavaFX/ScalaFX</h2> <p><a href="https://github.com/watermint/Fextile/blob/0.0.14">Fextile</a> is my project name which coined from JavaFX and textile. On the begining of the project, I just thought it’s easy to port Bootstrap’s CSS into JavaFX because JavaFX has similar feature called JavaFX CSS. But there are no compatibility except syntax. So I needed to create both JavaFX CSS and class libraries.</p> <p>Current implementation of Fextile built based upon ScalaFX. <a href="http://code.google.com/p/scalafx/">ScalaFX</a> is a DSL/wrapper of JavaFX on Scala.</p> <p><img src="/images/2013-12-13-fextile-sample1.png" alt="Sample 1"/></p> <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="nn">fextile.sample</span>

<span class="k">import</span> <span class="nn">fextile._</span>
<span class="k">import</span> <span class="nn">scalafx.application.JFXApp</span>
<span class="k">import</span> <span class="nn">scalafx.scene.control.Label</span>

<span class="k">object</span> <span class="nc">Sample1</span> <span class="k">extends</span> <span class="nc">JFXApp</span> <span class="o">{</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="nv">sample</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">VContainer</span> <span class="o">{</span>
    <span class="n">content</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">H1</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Fextile Sample"</span>
      <span class="o">},</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
      <span class="o">},</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
        <span class="n">styleClass</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"text-primary"</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">)</span>
  <span class="o">}</span>

  <span class="n">stage</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">JFXApp</span><span class="o">.</span><span class="py">PrimaryStage</span> <span class="o">{</span>
    <span class="n">title</span> <span class="k">=</span> <span class="s">"Fextile"</span>
    <span class="n">width</span> <span class="k">=</span> <span class="mi">800</span>
    <span class="n">height</span> <span class="k">=</span> <span class="mi">600</span>

    <span class="c1">// use fextile.Scene instead of scalafx.scene.Scene
</span>    <span class="n">scene</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Scene</span> <span class="o">{</span>
      <span class="n">root</span> <span class="k">=</span> <span class="n">sample</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li><a href="https://github.com/watermint/Fextile/blob/0.0.14/src/main/scala/fextile/sample/Sample1.scala">Sample1.scala</a></li> </ul> <p>Sample1; simple header and labels. First label uses default fonts, size and color. Second label uses “text-primary” class on Bootstrap. Fextile also defines “text-muted”, “text-warning”, etc.</p> <p><img src="/images/2013-12-13-fextile-sample2-wide.png" alt="Sample 2 - Wider screen"/></p> <p>Sample 2; responsive layout. This sample is responsive to screen width. On wider screen, texts are aligned as two columns.</p> <p><img src="/images/2013-12-13-fextile-sample2-narrow.png" alt="Sample 2 - Narrow screen"/></p> <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="nn">fextile.sample</span>

<span class="k">import</span> <span class="nn">fextile._</span>
<span class="k">import</span> <span class="nn">scalafx.scene.control.Label</span>
<span class="k">import</span> <span class="nn">scalafx.application.JFXApp</span>

<span class="k">object</span> <span class="nc">Sample2</span> <span class="k">extends</span> <span class="nc">JFXApp</span> <span class="o">{</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="nv">sample2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GridRow</span> <span class="o">{</span>
    <span class="nf">add</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">H1</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Responsive"</span>
      <span class="o">},</span>
      <span class="n">xs12</span><span class="o">,</span> <span class="n">sm12</span><span class="o">,</span> <span class="n">md12</span><span class="o">,</span> <span class="n">lg12</span>
    <span class="o">)</span>
    <span class="nf">add</span><span class="o">(</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
      <span class="o">},</span>
      <span class="n">xs12</span><span class="o">,</span> <span class="n">sm6</span><span class="o">,</span> <span class="n">md6</span><span class="o">,</span> <span class="n">lg6</span>
    <span class="o">)</span>
    <span class="nf">add</span><span class="o">(</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
        <span class="n">styleClass</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"text-primary"</span><span class="o">)</span>
      <span class="o">},</span>
      <span class="n">xs12</span><span class="o">,</span> <span class="n">sm6</span><span class="o">,</span> <span class="n">md6</span><span class="o">,</span> <span class="n">lg6</span>
    <span class="o">)</span>
  <span class="o">}</span>

  <span class="n">stage</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">JFXApp</span><span class="o">.</span><span class="py">PrimaryStage</span> <span class="o">{</span>
    <span class="n">title</span> <span class="k">=</span> <span class="s">"Fextile"</span>
    <span class="n">width</span> <span class="k">=</span> <span class="mi">800</span>
    <span class="n">height</span> <span class="k">=</span> <span class="mi">600</span>

    <span class="c1">// use fextile.Scene instead of scalafx.scene.Scene
</span>    <span class="n">scene</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Scene</span> <span class="o">{</span>
      <span class="n">root</span> <span class="k">=</span> <span class="n">sample2</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li><a href="https://github.com/watermint/Fextile/blob/0.0.14/src/main/scala/fextile/sample/Sample2.scala">Sample2.scala</a></li> </ul> <p>For narrow screen, text are aligned as one column.</p> <p><img src="/images/2013-12-13-fextile-sample3.png" alt="Sample3"/></p> <ul> <li><a href="https://github.com/watermint/Fextile/blob/0.0.14/src/main/scala/fextile/sample/Sample3.scala">Sample3.scala</a></li> </ul> <p>Sample 3; screen to screen navigation. This sample uses screen to screen navigation component like <code class="highlighter-rouge">UINavigationController</code> in iOS. Screen scroll left on “Next” button pressed.</p> <p><a href="https://github.com/watermint/Fextile">Fextile</a> is on early starge of development. If you’d like to have more components. Please send me pull-requests on github. Thanks.</p> </div> <div class="post"> <h1 class="post-title"> <a href="/2013/12/13/designing-ui-framework-for-javafx/"> JavaFXアプリケーションの手触り感をととのえる、Fextile </a> </h1> <span class="post-date"> 13th December 2013</span> <span class="post-tags"> #<a href="/tags/design">design</a> #<a href="/tags/fextile">fextile</a> #<a href="/tags/java">java</a> #<a href="/tags/javafx">javafx</a> #<a href="/tags/scala">scala</a> #<a href="/tags/scalafx">scalafx</a> #<a href="/tags/ui">ui</a> #<a href="/tags/ux">ux</a> </span> <p>この記事は<a href="http://www.adventar.org/calendars/146">JavaFX Advent Calendar 2013</a>の13日目、昨日は<a href="http://www1221uj.sakura.ne.jp/blog/">orekyuu</a>さんの<a href="http://www1221uj.sakura.ne.jp/blog/2013/12/javafx%E3%81%A7twitter%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F%E3%80%82/">JavaFXでTwitterクライアント作ってみた。</a>でした。</p> <h2 id="手触り感">手触り感</h2> <p>iOSや、Android、Windows、OS Xのアプリケーションは、アプリケーションの製作者が違っていてもだいたい同じような手触り感があります。これはラベルの配置や色、スペースの取り方、フォントのような見栄えはもちろんのこと、ボタンをおしたときのフィードバック、画面遷移の時のエフェクトなどさまざまな振る舞いがOSやUIフレームワークによってルールが規定されているためです。規定はたとえば次のようにガイドラインとして公開されています。</p> <ul> <li><a href="https://developer.apple.com/library/ios/documentation/userexperience/conceptual/mobilehig/">iOS Human Interface Guidelines</a></li> <li><a href="http://developer.android.com/design/index.html">Design Android Developers</a></li> <li><a href="http://msdn.microsoft.com/en-us/library/windowsphone/design/hh202915(v=vs.105).aspx">Design library for Windows Phone</a></li> </ul> <p>アプリケーション開発者はこれを参照し、アプリケーションに必要なUI/UXを作り上げていきます。iOSやWindows Phoneアプリケーションのように、アプリケーション公開までに審査があるようなケースではガイドラインに沿っていないアプリケーションは排除されるなどOSやデバイス全体のエコシステムとして手触り感の統一をしています。</p> <h2 id="クロスプラットホームの場合">クロスプラットホームの場合&lt;</h2> <p>ではWebアプリケーションの場合はどうでしょうか。WebアプリケーションはデバイスやOS、Webブラウザの種別やプラグインなどによって左右されることもありますが、モダンなデバイス／OSからであればたいていの環境で同じように動作します。この場合、iOSならではの手触り感、Androidならではの手触り感といったOSごとの手触り感とは違う別の手触り感が表現されることになります。Webアプリケーションでもいくつかルールやマナーはありますが、審査等はありませんので厳格かつ広く守られているガイドラインのようなモノは存在しません。</p> <p>自由にデザインできるという反面、自由度が高すぎて制作コストが高くなったり、制作期間が長引いてしまうというデメリットもあります。このような課題に対して、近年では<a href="http://getbootstrap.com">Twitter Bootstrap</a>のようにWebのデザインルールを決めたCSSやJavaScriptライブラリを使い、アプリケーションのテイストに合わせてテーマなどをカスタマイズする手法がとられることが多くなりました。</p> <p><img src="/images/2013-12-13-fextile-bootstrapcomponents.png" alt="Bootstrap UI components"/></p> <p>ヘッダやボタン、ラベルがある程度のカテゴリにわけられているため、Webアプリケーション開発者・デザイナーはこれらのカテゴリを利用してデザインを決定します。カテゴリと色やサイズなどはCSSとして分離されているため、プロトタイプ開発時にはデフォルトのデザインで作成しておき、リリース時には適切なブランドカラーを配置するなどデザイン作業に余裕が生まれます。</p> <h2 id="javafx">JavaFX</h2> <p>クロスプラットホームのUIを作る手段としてJavaはすでによく用いられています。一昔前はJavaアプレットがあまりにも重いという印象で敬遠されることもありましたが、近年では高速化も進み、10年ほど前のユーザエクスペリエンスが低い状態ではなくなりました。ただJavaのUIフレームワークはAWTとSwingという10年ほど前の状態からあまり進歩していませんでした。その間にはMicrosoftのSilverlightやAdobe AirなどデスクトップアプリケーションのためのUIライブラリが続々と登場し差は広がる一方でした。</p> <p>2008年にはJavaFX Scriptとして、新しく既存のAWT・Swingに変わるUIフレームワークが発表されました。当初、JavaFX ScriptとしてJava言語とは別の新しいプログラミング言語を使ってUIを構成するようにプロジェクトは進んでいましたが、紆余曲折の末、AWTやSwingと同様にJava言語から利用できるUIフレームワークと位置づけられてJavaFX 2がリリースされました。JavaFX 2ではWebKitエンジンを組み込んだモダンなWebView等を始めとして強力なコンポーネントが追加されました。クロスプラットホームで利用可能なUIフレームワークとして新たな選択肢が登場したといえます。</p> <h2 id="javafxと手触り感">JavaFXと手触り感</h2> <p>JavaFXには、ボタン、タブ、リストやテーブルなど多くのコントロールが提供されています。これらのデザインはプログラムから変更したり、JavaFX CSSをつかって外部ファイルにて定義することができます。</p> <p><img src="/images/2013-12-13-fextile-javafxcomponents.jpg" alt="JavaFX UIのコントロール"/></p> <p>JavaFXのコントロールは、一定のデザインテイストで制作されているためボタンやタブ、スクロールバーなどの手触り感は共通しています。ただ、ファイル削除など「破壊的な操作をするためのボタン」とか、決済をするための「同意をするためのボタン」といったユーザに対する意図を伝えるためのカテゴリ分けまでは定義されていません。このため開発者はそれぞれアプリケーションの都合に合わせて色やサイズを変えることになるのですが、自由度が高すぎて制作コストが高くなったりします。</p> <p>さて、この話何か見覚えがあります。これを解決するためには、Twitter BootstrapのようなUIフレームワークがJavaFX向けにあればいいのではないか。早速、そういったライブラリがないか探してみました。ただ、ある程度探してみた限りでは求めているようなUIフレームワークは見当たりませんでした。無ければ作るしかありません。</p> <h2 id="javafx向けのtwitter-bootstrapを作る">JavaFX向けのTwitter Bootstrapを作る</h2> <p>さて、JavaFXには前述の通りJavaFX CSSというCSSライクな機能が提供されています。ではTwitter BootstrapのCSSをそのまま移植すればよいのではないかというのが最初の考えでした。ただ、残念ながらJavaFX CSSとCSSは直接的な互換性はなく、またJavaFX CSSからは指定できない項目があるなど簡単な移植ではすまないということが分かり、JavaFX CSSと合わせてクラスライブラリも作成することにしました。</p> <p>Java言語で作ってもよかったのですが、今回は最近勉強中のScala言語を使って実装することにしました。Scalaには<a href="http://code.google.com/p/scalafx/">ScalaFX</a>というScalaからJavaFXを利用するためのライブラリがありますので、ScalaFXをベースに作ることにしました。</p> <h2 id="fextile">Fextile&lt;</h2> <p>ライブラリの名前はFextileにしました。テキスタイル(Textile; 織物、布地)とJavaFXを何となく合わせた造語です。まずはデザインテイストを全体的にTwitter Bootstrapに合わせてデザインし、実際のアプリケーションをデザインしながら優先度の高いコンポーネントを製作しました。でき上がったのが次のサンプルのようなコンポーネントです。</p> <p><img src="/images/2013-12-13-fextile-sample1.png" alt="Sample 1"/></p> <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="nn">fextile.sample</span>

<span class="k">import</span> <span class="nn">fextile._</span>
<span class="k">import</span> <span class="nn">scalafx.application.JFXApp</span>
<span class="k">import</span> <span class="nn">scalafx.scene.control.Label</span>

<span class="k">object</span> <span class="nc">Sample1</span> <span class="k">extends</span> <span class="nc">JFXApp</span> <span class="o">{</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="nv">sample</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">VContainer</span> <span class="o">{</span>
    <span class="n">content</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">H1</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Fextile Sample"</span>
      <span class="o">},</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
      <span class="o">},</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
        <span class="n">styleClass</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"text-primary"</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">)</span>
  <span class="o">}</span>

  <span class="n">stage</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">JFXApp</span><span class="o">.</span><span class="py">PrimaryStage</span> <span class="o">{</span>
    <span class="n">title</span> <span class="k">=</span> <span class="s">"Fextile"</span>
    <span class="n">width</span> <span class="k">=</span> <span class="mi">800</span>
    <span class="n">height</span> <span class="k">=</span> <span class="mi">600</span>

    <span class="c1">// use fextile.Scene instead of scalafx.scene.Scene
</span>    <span class="n">scene</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Scene</span> <span class="o">{</span>
      <span class="n">root</span> <span class="k">=</span> <span class="n">sample</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li><a href="https://github.com/watermint/Fextile/blob/0.0.14/src/main/scala/fextile/sample/Sample1.scala">Sample1.scala</a></li> </ul> <p>ヘッダとテキスト。サンプルではテキストの色はデフォルトのものと、Twitter Bootstrapでのtext-primary相当のものを使っています。JavaFX CSS側にはtext-muted、text-warningなど他のクラスを定義されていますので、利用シーンごとに指定を変えて使います。</p> <p>次のサンプルではデバイスや画面の広さによってコンポーネントの配置が適切に変更されるような、いわゆるレスポンシブデザインをサポートしたコンポーネントを利用しています。</p> <p><img src="/images/2013-12-13-fextile-sample2-wide.png" alt="Sample 2 - 画面が広い場合"/></p> <p>画面が狭くなると、2列に表示されていたコンポーネントは1列に整列し直されます。</p> <p><img src="/images/2013-12-13-fextile-sample2-narrow.png" alt="Sample 2 - 画面が狭い場合"/></p> <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="nn">fextile.sample</span>

<span class="k">import</span> <span class="nn">fextile._</span>
<span class="k">import</span> <span class="nn">scalafx.scene.control.Label</span>
<span class="k">import</span> <span class="nn">scalafx.application.JFXApp</span>

<span class="k">object</span> <span class="nc">Sample2</span> <span class="k">extends</span> <span class="nc">JFXApp</span> <span class="o">{</span>
  <span class="k">lazy</span> <span class="k">val</span> <span class="nv">sample2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">GridRow</span> <span class="o">{</span>
    <span class="nf">add</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">H1</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Responsive"</span>
      <span class="o">},</span>
      <span class="n">xs12</span><span class="o">,</span> <span class="n">sm12</span><span class="o">,</span> <span class="n">md12</span><span class="o">,</span> <span class="n">lg12</span>
    <span class="o">)</span>
    <span class="nf">add</span><span class="o">(</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
      <span class="o">},</span>
      <span class="n">xs12</span><span class="o">,</span> <span class="n">sm6</span><span class="o">,</span> <span class="n">md6</span><span class="o">,</span> <span class="n">lg6</span>
    <span class="o">)</span>
    <span class="nf">add</span><span class="o">(</span>
      <span class="k">new</span> <span class="nc">Label</span> <span class="o">{</span>
        <span class="n">text</span> <span class="k">=</span> <span class="s">"Lorem ipsum dolor sit amet, ex sit tempor ceteros interesset. Per ei epicuri complectitur, has quodsi accumsan consetetur eu. Vis at meis quando, ne nec ullum instructior. Vel dolore alienum explicari et, hinc inermis corpora vel an, nominati inciderint eam ad. Cum ex dolor malorum vituperata, cu possit equidem accusata cum."</span>
        <span class="n">wrapText</span> <span class="k">=</span> <span class="kc">true</span>
        <span class="n">styleClass</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"text-primary"</span><span class="o">)</span>
      <span class="o">},</span>
      <span class="n">xs12</span><span class="o">,</span> <span class="n">sm6</span><span class="o">,</span> <span class="n">md6</span><span class="o">,</span> <span class="n">lg6</span>
    <span class="o">)</span>
  <span class="o">}</span>

  <span class="n">stage</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">JFXApp</span><span class="o">.</span><span class="py">PrimaryStage</span> <span class="o">{</span>
    <span class="n">title</span> <span class="k">=</span> <span class="s">"Fextile"</span>
    <span class="n">width</span> <span class="k">=</span> <span class="mi">800</span>
    <span class="n">height</span> <span class="k">=</span> <span class="mi">600</span>

    <span class="c1">// use fextile.Scene instead of scalafx.scene.Scene
</span>    <span class="n">scene</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Scene</span> <span class="o">{</span>
      <span class="n">root</span> <span class="k">=</span> <span class="n">sample2</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li><a href="https://github.com/watermint/Fextile/blob/0.0.14/src/main/scala/fextile/sample/Sample2.scala">Sample2.scala</a></li> </ul> <p>次のサンプルではiOSのUINavigationControllerのように、1つの画面から左から右へとより詳細な情報を表示するためのコンポーネントを使っています。ボタンを押すと、画面全体が左へスライドし新しい画面が表示されます。</p> <p><img src="/images/2013-12-13-fextile-sample3.png" alt="Sample3"/></p> <ul> <li><a href="https://github.com/watermint/Fextile/blob/0.0.14/src/main/scala/fextile/sample/Sample3.scala">Sample3.scala</a></li> </ul> <p>いまのところこれだけですが、比較的実用的になってきました。これから実際のアプリケーションを実装する過程では、まだ多くのリファクタリングやコンポーネント追加が必要になりますが、簡単なユースケース向けにはひとまず形としてでき上がったかなと思っています。</p> <p><a href="https://github.com/watermint/Fextile/blob/0.0.14">Fextile</a>はMITライセンスにてオープンソースとして公開しておりますので、同じような問題で悩まれている方はぜひお使いいただき、新しい提案もいただければ幸いです。</p> </div> <div class="post"> <h1 class="post-title"> <a href="/2013/10/09/play-scala-logback-ltsv/"> Play 2.2/ScalaでLogbackの設定をLTSVにする </a> </h1> <span class="post-date"> 9th October 2013</span> <span class="post-tags"> #<a href="/tags/logback">logback</a> #<a href="/tags/logger">logger</a> #<a href="/tags/ltsv">ltsv</a> #<a href="/tags/playframework">playframework</a> #<a href="/tags/scala">scala</a> </span> <p>趣味のプログラムを<a href="http://www.playframework.com/documentation/2.2.x/Home">Play Framework 2.2</a>とScalaで書いています。趣味のプログラムなので、ログを監視したりするような事はまず無いのですが、あとからプログラムで読みやすいように<a href="http://ltsv.org/">LTSV (Labeled Tab-separated Values)</a>形式で出力する事にしてみました。</p> <p>ログの設定は、<code class="highlighter-rouge">conf/application-logger.xml</code>というファイルを作っておけば読み込んで適用してくれます。いろいろ試行錯誤した結果次のような設定で落ち着きました。</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;conversionRule</span> <span class="na">conversionWord=</span><span class="s">"coloredLevel"</span> <span class="na">converterClass=</span><span class="s">"play.api.Logger$ColoredLevel"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"FILE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;file&gt;</span>${application.home}/logs/application.log<span class="nt">&lt;/file&gt;</span>
        <span class="nt">&lt;rollingPolicy</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;fileNamePattern&gt;</span>${application.home}/logs/application.%d{yyyy-MM-dd}.log<span class="nt">&lt;/fileNamePattern&gt;</span>
            <span class="nt">&lt;maxHistory&gt;</span>14<span class="nt">&lt;/maxHistory&gt;</span>
        <span class="nt">&lt;/rollingPolicy&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;charset&gt;</span>UTF-8<span class="nt">&lt;/charset&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>time:%date{ISO8601}<span class="ni">&amp;#x9;</span>level:%level<span class="ni">&amp;#x9;</span>logger:%logger<span class="ni">&amp;#x9;</span>thread:%thread<span class="ni">&amp;#x9;</span>msg:%replace(%replace(%message){'\n','\\n'}){'\t',' '}<span class="ni">&amp;#x9;</span>exception:%replace(%replace(%xException{5}){'\n','\\n'}){'\t',' '}%n%nopex<span class="nt">&lt;/pattern&gt;</span>
            <span class="nt">&lt;immediateFlush&gt;</span>true<span class="nt">&lt;/immediateFlush&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%coloredLevel %logger{15} - %message%n%xException{5}<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"play"</span> <span class="na">level=</span><span class="s">"INFO"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"application"</span> <span class="na">level=</span><span class="s">"INFO"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"ERROR"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div> <p>STDOUTへの出力はデフォルトのままとしています。ファイル<code class="highlighter-rouge">${application.home}/logs/application.log</code>への書き込みのみLTSVとしています。</p> <p>最初からログローテーションまでは設定しなくても良いのですが、ちょっと作ってみた。というレベルのプログラムでも意外と長期間動かしっぱなしになってしまった。という事もあるので、あらかじめ設定しておく事にしています。</p> <p>ログに含める事ができる情報はLogbackのマニュアルによると<a href="http://logback.qos.ch/manual/layouts.html#conversionWord">Conversion Word</a>で定義されているものが使えるようです。呼び出しもとメソッド名や行番号もとれるようですが、動作速度が犠牲になるようなのでここでは有効にしませんでした。</p> <p>Play framework側のプロパティでapplication.home以外に使えるものはないのか情報を探してみましたが、ソースを見たところ(<a href="https://github.com/playframework/playframework/blob/2.2.x/framework/src/play/src/main/scala/play/api/Logger.scala#L171">Logger.scala</a>) application.home以外は特に定義されていませんでした。</p> </div> <div class="post"> <h1 class="post-title"> <a href="/2013/09/03/migrate-my-wordpress-blog-to-tumblr/"> WordPressからTumblrへ移行した話 </a> </h1> <span class="post-date"> 3rd September 2013</span> <span class="post-tags"> #<a href="/tags/cloudflare">cloudflare</a> #<a href="/tags/markdown">markdown</a> #<a href="/tags/tumblr">tumblr</a> #<a href="/tags/wordpress">wordpress</a> </span> <p><a href="http://watermint.org/post/59378228238/wordpress-tumblr">WordPressからtumblrへ、日記から文章へ</a>でも触れた通り、約7.8年<a href="http://www.sakura.ne.jp/standard.html">さくらのレンタルサーバ</a>でWordPressを使ってブログを配信していました。今回はこの移行についての経験をもう少し詳細に記録しておこうと思います。</p> <p>WordPressからTumblrへ移行した理由はいくつかあります。</p> <h2 id="パフォーマンス">パフォーマンス</h2> <p>表示速度が遅い。<a href="http://cloudflare.com">CloudFlare</a>のようなCDNも利用していましたが、それでも読み込み開始から描画終了までは8〜11秒程度かかっていました。これはWordPressだけが原因ではなくWordPressのWidgetなど多数のプラグイン、複数のドメインから配信される画像、アフィリエイト・分析のためのビーコン、サーバがレンタル共有型ゆえのCPUリソース不足など複合的な原因がありましたので今回大幅に見直しをかけています。</p> <p>今回、Tumblrから自動的に配信されるものをのぞき、アフィリエイトなども原則的には付与しない事にしました。ページレイアウトも可能な限りシンプルなものとして、読み込み速度と可読性の向上を目指しています。</p> <p>結果的には現在のところ描画終了まで2〜3秒とかなりの高速化が実現できました。なお、利用していたCDNのCloudFlareについてはTumblr側との技術的な相性の問題で利用できないようで使用をあきらめ、Tumblrのみで配信をする事にしました。</p> <ul> <li><a href="http://www.quora.com/CloudFlare/Why-has-tumblr-said-that-CloudFlare-is-not-compatible-with-tumblr-Is-CloudFlare-causing-technical-problems-for-tumblr-or-are-there-other-reasons">http://www.quora.com/CloudFlare/Why-has-tumblr-said-that-CloudFlare-is-not-compatible-with-tumblr-Is-CloudFlare-causing-technical-problems-for-tumblr-or-are-there-other-reasons</a></li> </ul> <p>振る舞いを見る限りだと、Tumblr側は定期的に、設定された該当のカスタムドメインのDNSを引いてみて、AレコードがTumblr (66.6.44.4)を向いているかどうかを確認しているようでした。ここで、確認が取れない場合は設定を無効化しているようです。無効化されると watermint.org にアクセスしても、Tumblrのエラーページが切なく表示されるだけになってしまします。</p> <p>当初、さくらインターネット側の設定を66.6.44.4に設定しただけでした。イメージ的にはこの設定をして24〜72時間ぐらいすればインターネットに設定が反映されて、うまく行くとおもっていました。ところが72時間経っても変化が無く、あせっていろいろ設定を変えてみたところCloudFlareのDNS設定でAレコードを、Off CloudFlareとして66.6.44.4を向けてみたところほぼリアルタイムで8.8.8.8 (Google Public DNS)なども更新され無事、ドメイン設定切り替えが完了しました。</p> <h2 id="セキュリティーメンテナンスの問題">セキュリティー、メンテナンスの問題</h2> <p>セキュリティー上の問題。WordPressは普及しているブログエンジンですが、その内部構造がやや複雑で、かつ多数のプラグインを使って構成しているためにそれぞれのコンポーネントにおけるセキュリティー上の問題がありそうで心配でした。あまりWordPressのソース自体をみて何か対策をするという事はありませんでしたが、精神衛生上のコストというイメージでしたが負担がありました。</p> <p>実際の作業は単にバージョンアップをするだけとはいえWordPress自身、プラグイン、テーマなど各コンポーネントは比較的バージョンアップサイクルが早いため、精神的な負担が高く感じていました。</p> <p>TumblrはCMS含めてのホスティングになるので、運営をほぼTumblr (Yahoo!)に任せる事が出来ますからこの点では非常に負担が軽くなったと思っています。</p> <h2 id="markdownのオーサリング">Markdownのオーサリング</h2> <p>最近、仕事を始め個人的なメモ等もほとんどをMarkdown形式で書くようにしています。そうするとブログ記事等もすべてMarkdownで書きたくなるのですが、WordPressには操作性・互換性の良いオーサリングプラグインが見当たりませんでした。</p> <p>WorldPressにMarkdown形式で記事投稿をするという点では、<a href="http://bywordapp.com">Byword 2</a>はかなり有力な候補でした。理由としてはもともとBywordの頃から手元のドキュメント編集に使っており操作性にも慣れていることがあります。</p> <p>しかし前述の通りパフォーマンスやセキュリティー／メンテナンスの問題などもありましたので、全体的な見直しをかけることで最終的な選択肢とはなりませんでした。</p> <h2 id="既存記事の移行">既存記事の移行</h2> <p>最終的に記事は移行しないと決めたのですが、検討した際の調べたところを紹介しておきます。</p> <p>WordPressで運用してきた過去の記事は7.8年でおおよそ500本になっていました。手動で移行するのはかなり面倒な量でした。選択肢としては次の2つの方式を検討していました。</p> <p>WordPressにはWordPress eXtended RSS (WXR)という形式で全記事をエクスポートする機能があります。これを、Tumblr API等を使ってTumblrへ移行するスクリプトを書く。Tumblr APIはすでに<a href="https://github.com/mitukiii/tumblife-for-ruby">tumblife</a>をつかってRubyで連携プログラムを書いた事があったのでこれを使えば良いだろうというところまでは検討しました。WXR形式のデータをパースしてTumblrへ流し込む形式にするのがやや面倒だったので一度保留としました。</p> <p>次に商用の移行サービスを検討しました。<a href="https://www.import2.com">Import2</a>というサービスがWordPressからTumblrへの移行をしてくれます。Import2は、WordPressとTumblr両方のID/Passwordを入れるとよしなに移行をしてくれるサービスで、サンプルとして10記事分を import2 demo というタグ付きで移行してくれます。WordPress側で画像を管理していた場合はさらにDropboxと連携するとDropbox側に画像を移行してURLなどもよしなに移行してくれるようです。 10記事分について移行してみたところ、おおむね問題なさそうに見えました。一つ問題があったのは日本語で書いた記事を編集しようとすると ＆#xxxxx; のようにユニコードでエスケープされた形式となってしまっており既存資産の移行という点ではやや難ありでした。サポートに問い合わせをすればなおったかもしれませんでしたが、結果的にはこの選択肢も保留としました。ちなみに、料金プランは500記事移行の場合、100記事〜1,000記事移行の<a href="https://www.import2.com/tumblr/pricing">Premiumプラン</a>となりUSD 49でした。もう少し安かったら勢いで移行していたかもしれません。</p> <p>記事を移行する／しないを判断する上で重要だったのはURLまでは移行できないことでした。Tumblrで各記事は「/post/記事ID/任意の文字列」のようなURL構造となるのでWordPressの既存URLをそのまま移行する事は出来ません。このような中途半端な移行かつ、過去の記事もすでに時代遅れとなっていることを勘案して最終的には記事移行をあきらめました。</p> <h2 id="tumblrに移行してみて">Tumblrに移行してみて</h2> <p>読者の立場としてみると、読み込み速度がかなり改善したのでこれは良かったと思っています。記事を書く立場です。WordPressのHTMLエディタで時々思った通りに入力できなくて結局HTMLを直書きするということがありました。 このあたりがMarkdownで書けるようになったのでかなり安心して書けるようになったと思います。もちろん、Markdownもいろいろ書式を使い始めると表示崩れがおこりがちです。今回からなるべく文体もわかりにくくならない程度に表組などを少なめにして箇条書き中心に書いています。</p> </div> <div class="post"> <h1 class="post-title"> <a href="/2013/08/26/workflow/"> 写真整理のワークフロー </a> </h1> <span class="post-date"> 26th August 2013</span> <span class="post-tags"> #<a href="/tags/aperture">aperture</a> #<a href="/tags/captureone">captureone</a> #<a href="/tags/lightroom">lightroom</a> #<a href="/tags/workflow">workflow</a> </span> <h2 id="aperture中心のワークフローからcapture-oneへ">Aperture中心のワークフローからCapture Oneへ&lt;</h2> <p>事の発端はAperture 3のアップデートが異様なまでにiPhoto側に仕様を寄せてきた事です。iCloudを使わせたいのはわかるけどUXまでiPhotoに寄せてくることには不安がありました。またこれに従い、Aperture自体の継続性ってどうなんだろうという疑問もありました。</p> <p>Aperture 3.2ぐらいまでは安定して動いていましたが、3.3ぐらいから急にバグらしき挙動が増えて作業に支障がでるようになってくるようになりました。Appleのことだから、コアにするならプロ向けのApertureではなく全製品を取り巻く環境の中心に位置づけたいiPhotoにするでしょう。それでここで見切りを付けて脱Apertureとしようとしたのが今年の1月頃です。</p> <p>その頃丁度いくつか製品を評価してCaptureOne 7が良いのではという気持ちになってきました。プレビューと最終イメージ(印刷 or RAW現像後のイメージ)が一致する、ヨーロピアンな色使い、パース調整などとにかく出力の気持ちよさにほれぼれしてこれを中核とすることに決めました。</p> <p>CaptureOneは商業カメラに詳しい方ならご存知の通り、デンマークのPhaseOne社がつくる現像ソフトウエアです。PhaseOneといえば、中判デジタルバックなどをすぐ連想されるとおもいますが、まさに商用写真／印刷向けのソリューション群を扱う会社なのです。CaptureOneもまさにそのコンセプトに沿っており、CYMK印刷、テザー撮影(スタジオなどでPCで確認しながら撮影する)などに特化していました。</p> <p>CaptureOneはversion 7より、おそらくハイアマチュア向けにかなりコンシューマ市場を意識した作りになっており、ApertureやLightroomでおなじみのカタログ形式(アプリが管理する配下にアプリ経由で写真をインポートし管理下におくような管理形式)の写真管理をサポート。</p> <p>CaptureOneはもともとその機能名にもある通り、Sessionというテザーセッション向けのディレクトリベースのファイル管理をベースとしておりカタログ形式はまさにCaptureOne 7での新機能でした。</p> <p>最初、2013年1月頃はCaptureOneを中核に据えるため、すべてをCaptureOneのカタログ形式にしようと既存の写真などをすべてカタログ配下に管理しようとしたのですがそこで問題が生じました。</p> <p>CaptureOneのカタログは明らかにシングルスレッドでの動作をしており、また、カタログに収容する写真枚数に比例して動作が遅くなる(O(n)で実行時間が長くなる)ため、実用的な収容枚数は1,000枚程度で、10,000枚を超えるとまず、カタログを読み込んで起動するだけで起動の成功率が1/3ぐらいという悲惨な状況でした。</p> <p>一眼レフでは月々1,000〜2,000枚程度撮影していますので毎月カタログを分けるようにしました。これで半年ほど運用してみましたが下記のような問題がありました。</p> <h2 id="capture-one-7の問題点">Capture One 7の問題点</h2> <ul> <li>写真の重複排除ができない。ApertureやLightroomを使っていれば当たり前の機能ですが、CaptureOneにはありません。SDカード/CFカードからの読み込み時に前回取り込みを消していなかったり、途中でCaptureOneがクラッシュするなど途中の状況がわからない場合でも手動ですべて解決せねばならずかなりつらい事がわかりました。</li> <li>頻繁にクラッシュする。使い方の問題ではあるのでしょうけど、CaptureOneは明らかにクラッシュし過ぎです。また、編集結果を即時にfsyncしないため、クラッシュするといくらか編集が巻き戻ってしまうという残念な状況に遭遇します。</li> <li>RAW+JPEGや、ムービーに対する対応が貧弱。RAW+JPEGはそもそも管理できず別々の写真として管理されます。ムービーについてはなんちゃってレベルで実装されているにすぎない印象。また、これもムービーの再生などをタイミングを同じくしてクラッシュするので未成熟さを感じます。</li> <li>かなり処理が遅い。Nikon D800で撮影したデータを扱っているのである程度遅いのは覚悟の上ですが、レーティングやメタデータ編集といった画質とは関係のない操作でもApertureやLightroomと比べれば桁が一つ二つ違うぐらい応答速度が異なります。</li> </ul> <p>一方次のようなこともわかりました。</p> <p>CaptureOneでカタログ管理ではなく、セッション管理とすれば処理速度の低下傾向からO(n)ではなく、O(1)になる。CaptureOneのカタログに対する操作は明らかにUIの更新 → Update → UIの更新となっていて、100枚も写真を削除したり移動しようものなら、数十分は制御が帰ってこないという、泣けてくる実装です(すくなくともCaptureOne 7.1.3まででは)。セッション管理とすると、その状況が嘘のように、普通のちょっと重めなアプリとして動作してくれます。</p> <h2 id="ワークフロー">ワークフロー</h2> <p>以上のような問題から、CaptureOneをオーサリングの中核とする事はあきらめて、メモリカードからの取り込み／取捨選択／キーワードの付与はCaptureOneではなくLightroomで、それ以降のポストプロダクション処理はCaptureOneでやることにしました。</p> <p>取り込み／取捨選択／キーワード付与をApertureではなくLightroomにしたのは、CaptureOneとの連携のためです。Apertureはカタログ形式、つまり、Apertureが指定したディレクトリ構造しかサポートしませんが、Lightroomは取り込みデータ+XMP(写真メタデータ)をある程度自由にディレクトリ構成をデザインできるため、CaptureOneのセッションディレクトリと共有できるためです。</p> <p>Lightroomでのメタデータ編集結果を共有するためにカタログ設定の「変更点をXMPに自動的に書き込む」をオンにしておきます。 CaptureOne側で該当のファイルをすでに読み込んでいるならば「ファイル」→「メタデータの読み出し」で再読み込みすればXMPファイルからメタデータを取得してくれます。</p> <p>現状の写真管理ワークフローについてまとめます。</p> <p><img src="/images/2013-08-26-workflow1.png" alt="ワークフロー"/></p> <p>SD/CFカードからはLightroomに取り込み、その取り込み先ディレクトリはCaptureOneセッションが利用するディレクトリと共有しておきます(CaptureOne側からセッションお気に入りフォルダに設定する)。</p> <p>CaptureOneに読み込まれたら、あとは必要な写真をメタデータ＋フィルタによって絞り込み、編集します。</p> <p>ムービーデータについてはCaptureOneに持ち込む前に、LightroomからPremiereのプロジェクトに渡します。Peremiereに渡した後は、音量、手振れ補正などをそれぞれAuditionならびにAfterEffectsなどで行います。タイトルロゴ、字幕なども同様に編集します。</p> <p>HDR向けないし、パノラマ写真を時々撮る事があるのですがこれはLightroomから直接ファイルを複数選択してそのように編集するメニューがありますのでそのように編集します。その他高度な編集はPhotoshop側で行います。</p> <p>写真管理ソフトウエアにはたいてい印刷サービスが連携されていますが、Lightroom 5とApertureを比べるとデザインテンプレートなどの差でApertureに圧倒的な軍配が上がると思っています。Adobe製品は全体的に、テンプレートとかサンプル・素材が少なく、3rdパーティー製品を買う事が前提となっていますがAppleのそれはある程度高品質なテンプレート・サンプル・素材がそろっており、これだけでも十二分な利用価値があります。Apertureで発注したフォトブックはAppleの決済後、各国の印刷パートナーが印刷して配送するようです。いままでに何回かフォトブックを作っていますが、クオリティー・満足度は非常に高いです。値段はさほど高くないながら、納期も5営業日(首都圏だからかもしれませんがたいてい5営業日ではなく、5日以内に届きます)に届き、色管理も十分にしていない中でもはずれがありません。Lightroomのフォトブックは、これに比べるとかなりいろいろな点をスクラッチから作らざるを得ず、少し敷居が高く感じます。</p> <p>オンラインでの写真共有はflickr、everpix、tumblrを使っています。flickrは旧来のproアカウントを継続しているので容量無制限でアップロード可能です。everpixは無料アカウントで利用しています。無料アカウントでは12ヶ月前までの写真が無制限にアップロードできます。招待などいくつかアクションを行う事でこの期間制限は延長されます。月4.99米ドルで無制限になります。flickrからの同期によるアップロードもサポートしていていまはflickrのバックアップ用に使っています。flickrは公開レベルが家族、友達などコンタクト先属性を意識しますが、everpixはアルバムごとに公開URLを作れるなど短期的な画像共有には非常に相性の良いサービスと思っています。その他に、写真共有ではtumblrを使っていますが、これは自分の良いと思う代表的な写真をのせるために使っています。flickrやeverpixは容量無制限という魅力からほぼすべてシャッターを切った写真をアップロードしていますが、ある程度絞り込んだ結果として自分の写真を管理したいという思いからtumblrに写真を載せています。</p> <p>flickrならびにtumblrへのアップロードは自作のスクリプトを使っています。flickrアップロードスクリプトを作成したモチベーションは、月々数十ギガのファイルを不安定なネットワーク環境でアップロードする際、既存のアップローダーでは対応ができなかったからです。tumblrについては、EXIF情報からより多くのタグを付与してアップロードしたり、コメントを整形するために使っています。</p> <p>写真１枚１枚自体の管理についてですが、このワークフローではxmpファイルが大きな意味を持っています。Lightroomでつけたタグやコメントはそのままtumblrなどに運ばれるように作っています。</p> <h2 id="各ソフトウエアの良いところと悪いところ">各ソフトウエアの良いところと、悪いところ。</h2> <p>1ヶ月このワークフローで写真整理をしてみました。その中ででてきた各ソフトウエアの良いところ、悪いところを整理しておきます。</p> <p>Aperture 3 - 手元にあるソフトウエアの中で最も使い勝手がよく作られています。キーボードショートカットのカスタマイズや、選択、ルーペでの拡大捜査など基本的な機能が洗練されていて、派手さはありませんが最も生産的な作業が出来ると思います。一方、課題としてはAppleの方針がころころ変わってしまうために、やや振り回されている感がある事です。</p> <p>Capture One 7 - 自動色調補正、現像処理、色調調整、キーストーン調整、ウォーターマークの挿入など仕上がりについて満足のいく結果を安定的に返してくれます。色調などは好みはあるとおもいますが、自動補正の際にあまりハイライトなどが破綻しない傾向があるとおもいます。一方、課題としては操作が重かったり、頻繁にクラッシュすることがあげられます。</p> <p>Lightroom 5 - 全体的に軽快に動き、Adobe製品群との連携メニューが豊富なところが売りです。ファイル管理形式が柔軟なところも便利です。一方、課題としてはUI/UXが全体的に未熟なところです。モードによって選択範囲に対する操作の適用範囲が違ったり、Camera Rawなどでは空気を読んで適切な場所にフォーカスをあててくれたりするのにLightroomはそういう配慮がありません。</p> </div> </div> <div class="pagination"> <a class="pagination-item older" href="/page10">Older</a> <a class="pagination-item newer" href="/page8">Newer</a> </div> </div> <div class="container copyright"> &copy; 2016-2020 Takayuki Okazaki </div> </div> <label for="sidebar-checkbox" class="sidebar-toggle"></label> <script>!function(e){var r=e.querySelector(".sidebar-toggle"),t=e.querySelector("#sidebar"),n=e.querySelector("#sidebar-checkbox");e.addEventListener("click",function(e){var c=e.target;n.checked&&!t.contains(c)&&c!==n&&c!==r&&(n.checked=!1)},!1)}(document);</script> <script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-769616-6","auto"),ga("send","pageview");</script> </body> </html>