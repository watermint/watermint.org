<!DOCTYPE html> <html> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> Using ELK(ElasticSearch 1.4.2 + Logstash 1.4.2 + Kibana 4 Beta3) &middot; watermint.org </title> <link rel="stylesheet" href="/public/watermint.css"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/watermint-logo.png"> <link rel="shortcut icon" href="/public/watermint-logo.png"> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> </head> <body class="theme-base-09"> <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"> <div class="sidebar" id="sidebar"> <div class="sidebar-item"> <p>Travel, camera, photo, and technical things. I work at Dropbox. Thoughts are my own.</p> </div> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Home</a> <a class="sidebar-nav-item" href="/about/">About</a> <a class="sidebar-nav-item" href="/atom.xml">Feed</a> <a class="sidebar-nav-item" href="https://github.com/watermint">Github</a> <a class="sidebar-nav-item" href="https://www.instagram.com/watermint/">Instagram</a> </nav> <div class="sidebar-item"> <p> &copy; 2005-2017 Takayuki Okazaki </p> </div> </div> <div class="wrap"> <div class="masthead"> <div class="container"> <h3 class="masthead-title"> <a href="/" title="Home">watermint.org</a> <small>- Takayuki Okazaki's note</small> </h3> </div> </div> <div class="container content"> <div class="post"> <h1 class="post-title">Using ELK(ElasticSearch 1.4.2 + Logstash 1.4.2 + Kibana 4 Beta3)</h1> <span class="post-date"> 24th December 2014</span> <h1 id="demonstration-on-elk-on-mac-os-x-yosemite">Demonstration on ELK on Mac OS X (Yosemite)</h1> <h2 id="download">Download</h2> <ul> <li>http://www.elasticsearch.org/overview/elkdownloads/</li> </ul> <h2 id="setup---elasticsearch">Setup - ElasticSearch</h2> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>unzip elasticsearch-1.4.2.zip
</code></pre> </div> <h3 id="configure">Configure</h3> <p>Configure elasticsearch to allow connection from Kibana4. Add following two lines into $ELASTICSEARCH_HOME/conf/elasticsearch.yml</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">http.cors.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">http.cors.allow-origin</span><span class="pi">:</span> <span class="s">/.*/</span>
</code></pre> </div> <h3 id="startup">Startup</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>./bin/elasticsearch
</code></pre> </div> <h3 id="test">Test</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl localhost:9200
</code></pre> </div> <h2 id="logstash-142">Logstash 1.4.2</h2> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>unzip logstash-1.4.2.zip
</code></pre> </div> <p>You have to replace elasticsearch libraries inside logstash.</p> <ul> <li>https://github.com/elasticsearch/kibana/issues/1629#issuecomment-64172892</li> <li>logstash contains old version of elasticsearch (1.1.1).</li> <li>Kibana4 requires elasticsearch 1.4.0 or higher.</li> </ul> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">cd </span>logstash-1.4.2/vendor/jar
<span class="gp">$ </span>rm -fr elasticsearch-1.1.1
<span class="gp">$ </span>unzip <span class="nv">$YOUR_DOWNLOAD_DIR</span>/elasticsearch-1.4.2.zip
</code></pre> </div> <h3 id="test-configuration">Test configuration</h3> <p>Save file like below as test-logstash.conf</p> <div class="highlighter-rouge"><pre class="highlight"><code>input {
  file {
    type =&gt; "apache"
    path =&gt; "/var/log/apache2/access_log"
  }
}

output {
  elasticsearch {
    host =&gt; localhost
  }
}
</code></pre> </div> <h3 id="startup-1">Startup</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>./bin/logstash -f <span class="nb">test</span>-logstash.conf
</code></pre> </div> <h3 id="test-1">Test</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo apachectl start
<span class="gp">$ </span>curl localhost
</code></pre> </div> <h2 id="kibana-4-beta-3">Kibana 4 Beta 3</h2> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>unzip kibana-4.0.0-beta3.zip
</code></pre> </div> <h3 id="startup-2">Startup</h3> <div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>./bin/kibana
</code></pre> </div> <h3 id="test-2">Test</h3> <p>Open http://localhost:5601 with your browser. Configure index pattern with time-based events.</p> <ul> <li>Check “Index contains time-based events”</li> <li>Index name or pattern: logstash-*</li> <li>Choose Time-field name: <code class="highlighter-rouge">@timestamp</code></li> </ul> <p><img src="/images/2014-12-24-kibana.jpg" alt="Kibana4.png"/></p> </div> <div class="related"> <h2>Related Posts</h2> <ul class="related-posts"> <li> <a href="/2016/12/31/digital-filing/"> デジタルファイリング - データの整理整頓 <small>- 31st December 2016</small> </a> </li> <li> <a href="/2016/12/15/go-bandwidth-limit-for-multilpe-io/"> Go: 複数のReader/Writerに対する帯域幅制御 <small>- 15th December 2016</small> </a> </li> <li> <a href="/2016/12/14/dmg-and-cli-en/"> Disk image file (.dmg) from command line <small>- 14th December 2016</small> </a> </li> </ul> </div> </div> <div class="container copyright"> &copy; 2005-2017 Takayuki Okazaki </div> </div> <label for="sidebar-checkbox" class="sidebar-toggle"></label> <script>!function(e){var c=e.querySelector(".sidebar-toggle"),r=e.querySelector("#sidebar"),t=e.querySelector("#sidebar-checkbox");e.addEventListener("click",function(e){var n=e.target;t.checked&&!r.contains(n)&&n!==t&&n!==c&&(t.checked=!1)},!1)}(document);</script> <script>!function(e,t,a,n,c,s,o){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,s=t.createElement(a),o=t.getElementsByTagName(a)[0],s.async=1,s.src=n,o.parentNode.insertBefore(s,o)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-769616-6","auto"),ga("send","pageview");</script> </body> </html>